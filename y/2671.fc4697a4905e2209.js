"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2671],{2671:(H,d,r)=>{r.r(d),r.d(d,{AgregarHuecaPageModule:()=>P});var h=r(6895),u=r(433),i=r(6948),l=r(2435),f=r(5861),e=r(4650),m=r(7618),A=r(3858);function b(t,s){1&t&&e._UZ(0,"ion-img",15),2&t&&e.Q6J("src",s.$implicit.url)}let p=(()=>{class t{constructor(n,o,a){this.geolocation=n,this.firebaseService=o,this.router=a,this.latitude=0,this.longitude=0,this.nombreLocacion="",this.descripcionLocacion="",this.fotosLocacion=[],this.fotosPreview=[]}getCurrentCoordinates(){var n=this;return(0,f.Z)(function*(){try{const o=yield n.geolocation.getCurrentPosition();n.latitude=o.coords.latitude,n.longitude=o.coords.longitude}catch(o){console.log("Error, no se puede obtener tu ubicaci\xf3n",o)}})()}onFilesSelected(n){const o=n.target;if(o.files&&o.files.length>0){this.fotosLocacion=[],this.fotosPreview=[];for(let a=0;a<Math.min(o.files.length,3);a++){const c=o.files[a];this.fotosLocacion.push(c);const g=new FileReader;g.onload=()=>{this.fotosPreview.push({file:c,url:g.result})},g.readAsDataURL(c)}}}guardarHueca(){this.nombreLocacion&&this.descripcionLocacion&&this.latitude&&this.longitude&&this.fotosLocacion.length>0?this.firebaseService.guardarDatosHuecaConFotos(this.nombreLocacion,this.descripcionLocacion,this.latitude,this.longitude,this.fotosLocacion).then(()=>{console.log("Hueca y fotos guardadas en Firebase"),this.router.navigate(["/home"])}).catch(n=>{console.error("Error al guardar la hueca y fotos en Firebase:",n)}):console.error("Todos los campos y al menos una foto son requeridos")}redirectToHome(){this.router.navigate(["/home"])}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(m.b),e.Y36(A.O),e.Y36(l.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-agregar-hueca"]],decls:42,vars:7,consts:[[3,"translucent"],[3,"fullscreen"],["lines","none"],["type","file","accept","image/*","multiple","",3,"change"],[1,"image-container"],["class","selected-photo",3,"src",4,"ngFor","ngForOf"],["position","floating"],["type","text",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["expand","block",3,"click"],["color","danger","slot","end"],["expand","full",1,"save-button",3,"click"],["vertical","bottom","horizontal","end",2,"margin-bottom","30px"],["type","submit",3,"click"],["name","chevron-back-outline"],[1,"selected-photo",3,"src"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Agregar Hueca"),e.qZA()()(),e.TgZ(4,"ion-content",1)(5,"ion-list")(6,"ion-item",2)(7,"ion-label"),e._uU(8,"Fotos (m\xe1x. 3)"),e.qZA()(),e.TgZ(9,"ion-item",2)(10,"input",3),e.NdJ("change",function(c){return o.onFilesSelected(c)}),e.qZA()(),e.TgZ(11,"div",4),e.YNc(12,b,1,1,"ion-img",5),e.qZA(),e.TgZ(13,"ion-item")(14,"ion-label",6),e._uU(15,"Nombre de la Hueca"),e.qZA(),e.TgZ(16,"ion-input",7),e.NdJ("ngModelChange",function(c){return o.nombreLocacion=c}),e.qZA()(),e.TgZ(17,"ion-item")(18,"ion-label",6),e._uU(19,"Descripci\xf3n"),e.qZA(),e.TgZ(20,"ion-textarea",8),e.NdJ("ngModelChange",function(c){return o.descripcionLocacion=c}),e.qZA()(),e.TgZ(21,"ion-list-header"),e._uU(22," Coordenadas de la ubicaci\xf3n "),e.qZA(),e.TgZ(23,"ion-item")(24,"ion-button",9),e.NdJ("click",function(){return o.getCurrentCoordinates()}),e._uU(25," Obtener ubicaci\xf3n "),e.qZA()(),e.TgZ(26,"ion-item")(27,"ion-label"),e._uU(28,"Latitud"),e.qZA(),e.TgZ(29,"ion-badge",10),e._uU(30),e.qZA()(),e.TgZ(31,"ion-item")(32,"ion-label"),e._uU(33,"Longitud"),e.qZA(),e.TgZ(34,"ion-badge",10),e._uU(35),e.qZA()(),e.TgZ(36,"ion-item",2)(37,"ion-button",11),e.NdJ("click",function(){return o.guardarHueca()}),e._uU(38," Guardar Hueca "),e.qZA()()(),e.TgZ(39,"ion-fab",12)(40,"ion-fab-button",13),e.NdJ("click",function(){return o.redirectToHome()}),e._UZ(41,"ion-icon",14),e.qZA()()()),2&n&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(8),e.Q6J("ngForOf",o.fotosPreview),e.xp6(4),e.Q6J("ngModel",o.nombreLocacion),e.xp6(4),e.Q6J("ngModel",o.descripcionLocacion),e.xp6(10),e.Oqu(o.latitude),e.xp6(5),e.Oqu(o.longitude))},dependencies:[h.sg,u.JJ,u.On,i.yp,i.YG,i.W2,i.IJ,i.W4,i.Gu,i.gu,i.Xz,i.pK,i.Ie,i.Q$,i.q_,i.yh,i.g2,i.wd,i.sr,i.j9],styles:['@charset "UTF-8";.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px}.image-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;flex-wrap:wrap;gap:10px}.selected-photo[_ngcontent-%COMP%]{max-width:200px;max-height:200px;width:auto;height:auto}.save-button[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:50%;transform:translate(-50%);border-radius:50px;width:80%}']}),t})();const Z=[{path:"",component:p}];let T=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[l.Bz.forChild(Z),l.Bz]}),t})(),P=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.ez,u.u5,i.Pc,T,l.Bz.forChild([{path:"",component:p}])]}),t})()}}]);